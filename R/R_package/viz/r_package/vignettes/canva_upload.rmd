---
title: "Uploading graphs and tables to Canva"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{canva_upload}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(rmarkdown.html_vignette.check_title = FALSE)
```

```{r setup}
library(canviz)
```

## A brief introduction to pushing content in R or Python to Canva.

You've created a graph or table in R/Python and want to move this file over to Canva without having to download then go to your downloads folder, then upload to Canva. How tedious! What if you could upload this content programatically? Cool, hey! This post will teach you how to do just that.

Take the `gapminder` dataset, popularized by Hans Rosling. In `R`, the dataset has been loaded into `canviz` already.  In `Python` we can find the data by running `from gapminder import gapminder`.

## Example code {.tabset} 

### R code

We'll create a graph in Flourish that looks at life expectancy by GDP per capita in the last year of data collection.

```{r}
gapminder_data <- subset(gapminder, year == max(year))

gapminder_graph <- flourish(
  data = gapminder_data,
  chart_type = "scatter",
  chart_description = "life expectancy by GDP per capita"
) |>
  bind_data(
    x = "lifeExp",
    y = "gdpPercap",
    add_to_popup_panel = c("country", "pop")
  ) |>
  chart_layout(
    y_axis_title = "GDP per capita ($PPP)",
    x_axis_title = "Life expectancy",
    x_axis_gridline_show = TRUE
  ) |>
  chart_number_date_format(
    y_axis_prefix = "$",
    y_axis_n_decimals = 0,
    y_axis_strip_separator = FALSE,
    x_axis_suffix = " years"
  )

gapminder_graph
```

We want to publish this in Canva. To do this we'll run the following function. 

**Note: Pushing HTML content doesn't work at the moment.**
```{r}
canva_upload(
  plot_object = gapminder_graph,
  plot_width = 6,
  plot_height = 4,
  plot_units = "in",
  plot_title = "Life exp. by GDP per cap.",
  transparent_bg = FALSE,
  file_format = "html"
)
```

Let's try this using `ggplot2`.

```{r}
gapminder_graph1 <- ggplot2::ggplot(gapminder_data, ggplot2::aes(x = lifeExp, y = gdpPercap)) +
  ggplot2::geom_point() +
  ggplot2::theme_minimal() +
  ggplot2::labs(
    y = "GDP per cap ($PPP)",
    x = "Life expectancy"
  )
gapminder_graph1
```
```{r}
canva_upload(
  plot_object = gapminder_graph1,
  plot_width = 6,
  plot_height = 4,
  plot_units = "in",
  plot_title = "Life exp. by GDP per cap.",
  transparent_bg = FALSE,
  file_format = "svg"
)
```


### Python code 

**Ignore -- not set up yet** 

```{python}

```

